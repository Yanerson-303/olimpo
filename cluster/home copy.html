<!DOCTYPE html>
<html lang="es">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link rel="icon" type="image/png" href="data/img/casco-logo.png">
  <title>Legiones de Roma - Sistema de Virtud</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
  <link rel="stylesheet" href="styles/global.css">
  <link rel="stylesheet" href="styles/home.css">
</head>

<body class="bg-light">
  <!-- Efectos de luces ambientales -->
  <div class="light-effect light-1"></div>
  <div class="light-effect light-2"></div>
  <div class="light-effect light-3"></div>


  <!-- 🎵 Música de fondo simultánea y compatible -->
  <audio id="bg-music1" src="data/sound/fuego.mp3" preload="auto" loop></audio>
  <audio id="bg-music2" src="data/sound/aura.mp3" preload="auto" loop></audio>

  <script>
    document.addEventListener("DOMContentLoaded", () => {
      const audio1 = document.getElementById("bg-music1");
      const audio2 = document.getElementById("bg-music2");

      // Inicializar en silencio (previene bloqueos automáticos)
      audio1.volume = 0;
      audio2.volume = 0;

      // Función para reproducir ambos audios con fundido de entrada
      const playAudios = () => {
        Promise.all([audio1.play(), audio2.play()])
          .then(() => {
            console.log("🔊 Reproducción iniciada correctamente");

            // Efecto de fade-in (subida gradual del volumen)
            let vol = 0;
            const fade = setInterval(() => {
              vol += 0.05;
              if (vol >= 1) {
                vol = 1;
                clearInterval(fade);
              }
              audio1.volume = vol;
              audio2.volume = vol;
            }, 200);
          })
          .catch(err => {
            console.warn("⚠️ Error al reproducir automáticamente:", err);
          });
      };

      // Intentar reproducir automáticamente al cargar
      playAudios();

      // En caso de bloqueo (móviles o navegadores estrictos)
      const enableOnUserInteraction = () => {
        playAudios();
        document.removeEventListener("click", enableOnUserInteraction);
        document.removeEventListener("touchstart", enableOnUserInteraction);
      };

      // Detectar primer clic o toque en pantalla
      document.addEventListener("click", enableOnUserInteraction, { once: true });
      document.addEventListener("touchstart", enableOnUserInteraction, { once: true });
    });
  </script>


  <!-- ====== 🎯 CABECERA PRINCIPAL FUSIONADA ====== -->
  <header class="main-header">
    <div class="container-fluid">
      <div class="row align-items-center">
    <!-- ====== 🏪 TIENDA (Izquierda) ====== -->
    <div class="col-12 col-md-3 col-lg-2 mb-2 mb-md-0">
      <div class="d-flex justify-content-center justify-content-md-start">
        <button class="btn btn-outline-light d-flex align-items-center" type="button" onclick="mostrarTienda()">
          <span class="me-2">🏪</span>
          <span>Tienda</span>
        </button>
      </div>
    </div>


        <!-- ====== 💰 ESTADÍSTICAS (Centro) ====== -->
        <div class="col-12 col-md-6 col-lg-8 mb-2 mb-md-0">
          <div class="row justify-content-center g-2 g-sm-3">

            <!-- Dragmas -->
            <div class="col-6 col-sm-4 col-md-3 col-lg-2">
              <div class="stat-item bg-secondary bg-opacity-25 rounded p-2 text-center" title="Dragmas disponibles">
                <div class="stat-icon fs-5">💰</div>
                <div class="stat-value fw-bold" id="dragmas-count">1,250</div>
                <div class="stat-label small">Dragmas</div>
              </div>
            </div>

            <!-- Poder -->
            <div class="col-6 col-sm-4 col-md-3 col-lg-2">
              <div class="stat-item bg-secondary bg-opacity-25 rounded p-2 text-center" title="Nivel de poder físico">
                <div class="stat-icon fs-5">💪</div>
                <div class="stat-value fw-bold" id="poder-count">85</div>
                <div class="stat-label small">Poder</div>
              </div>
            </div>

            <!-- Conocimiento -->
            <div class="col-6 col-sm-4 col-md-3 col-lg-2">
              <div class="stat-item bg-secondary bg-opacity-25 rounded p-2 text-center" title="Conocimiento acumulado">
                <div class="stat-icon fs-5">📚</div>
                <div class="stat-value fw-bold" id="conocimiento-count">42</div>
                <div class="stat-label small">Conocimiento</div>
              </div>
            </div>

            <!-- Influencia -->
            <div class="col-6 col-sm-4 col-md-3 col-lg-2">
              <div class="stat-item bg-secondary bg-opacity-25 rounded p-2 text-center" title="Influencia social">
                <div class="stat-icon fs-5">🗣️</div>
                <div class="stat-value fw-bold" id="influencia-count">67</div>
                <div class="stat-label small">Influencia</div>
              </div>
            </div>

            <!-- Amigos -->
            <div class="col-6 col-sm-4 col-md-3 col-lg-2">
              <div class="stat-item bg-secondary bg-opacity-25 rounded p-2 text-center" title="Círculo de amigos">
                <div class="stat-icon fs-5">👥</div>
                <div class="stat-value fw-bold">
                  <span id="amigos-count">23</span>
                  <span class="stat-limit small opacity-75">/50</span>
                </div>
                <div class="stat-label small">Amigos</div>
              </div>
            </div>

          </div>
        </div>

        <!-- ====== 👤 PERFIL Y MISIONES (Derecha) ====== -->
        <div class="col-12 col-md-3 col-lg-2">
          <div class="d-flex justify-content-center justify-content-md-end align-items-center">

    <!-- ====== 📜 MISIONES (Derecha) ====== -->
    <div class="col-12 col-md-3 col-lg-2">
      <div class="d-flex justify-content-center justify-content-md-end">
        <button class="btn btn-warning d-flex align-items-center" type="button" onclick="mostrarMisiones()">
          <span class="me-2">📜</span>
          <span>Misiones</span>
        </button>
      </div>

            <!-- Imagen de Perfil -->
            <div class="dropdown">
              <a href="#" class="d-block link-body-emphasis text-decoration-none dropdown-toggle"
                data-bs-toggle="dropdown" aria-expanded="false">
                <img src="https://github.com/mdo.png" alt="Perfil" width="40" height="40"
                  class="rounded-circle profile-img">
              </a>
              <ul class="dropdown-menu text-small shadow">
                <li><a class="dropdown-item" href="#">Nuevo proyecto...</a></li>
                <li><a class="dropdown-item" href="#">Configuración</a></li>
                <li><a class="dropdown-item" href="#">Perfil</a></li>
                <li>
                  <hr class="dropdown-divider">
                </li>
                <li><a class="dropdown-item" href="#">Cerrar sesión</a></li>
              </ul>
            </div>
          </div>
        </div>
      </div>
    </div>
  </header>

  <!-- ====== 📦 CONTENIDO PRINCIPAL ====== -->
  <div class="container-fluid py-4">
    <div class="row g-4">
      <!-- Módulo con los 5 contadores -->
      <div class="col-md-6">
        <div class="bg-white border rounded-3 p-4 shadow-sm">
          <h4 class="mb-4">Estadísticas Detalladas</h4>
          <div class="row g-3">
            <div class="col-12">
              <div class="d-flex justify-content-between align-items-center p-3 bg-light rounded">
                <div class="d-flex align-items-center">
                  <span class="fs-4 me-3">💰</span>
                  <div>
                    <div class="fw-bold">Dragmas</div>
                    <div class="small text-muted">Moneda principal</div>
                  </div>
                </div>
                <div class="fs-5 fw-bold text-primary">1,250</div>
              </div>
            </div>
            <div class="col-12">
              <div class="d-flex justify-content-between align-items-center p-3 bg-light rounded">
                <div class="d-flex align-items-center">
                  <span class="fs-4 me-3">💪</span>
                  <div>
                    <div class="fw-bold">Poder</div>
                    <div class="small text-muted">Fuerza física</div>
                  </div>
                </div>
                <div class="fs-5 fw-bold text-success">85</div>
              </div>
            </div>
            <div class="col-12">
              <div class="d-flex justify-content-between align-items-center p-3 bg-light rounded">
                <div class="d-flex align-items-center">
                  <span class="fs-4 me-3">📚</span>
                  <div>
                    <div class="fw-bold">Conocimiento</div>
                    <div class="small text-muted">Sabiduría acumulada</div>
                  </div>
                </div>
                <div class="fs-5 fw-bold text-info">42</div>
              </div>
            </div>
            <div class="col-12">
              <div class="d-flex justify-content-between align-items-center p-3 bg-light rounded">
                <div class="d-flex align-items-center">
                  <span class="fs-4 me-3">🗣️</span>
                  <div>
                    <div class="fw-bold">Influencia</div>
                    <div class="small text-muted">Capacidad de persuasión</div>
                  </div>
                </div>
                <div class="fs-5 fw-bold text-warning">67</div>
              </div>
            </div>
            <div class="col-12">
              <div class="d-flex justify-content-between align-items-center p-3 bg-light rounded">
                <div class="d-flex align-items-center">
                  <span class="fs-4 me-3">👥</span>
                  <div>
                    <div class="fw-bold">Amigos</div>
                    <div class="small text-muted">Conexiones sociales</div>
                  </div>
                </div>
                <div class="fs-5 fw-bold text-secondary">23/50</div>
              </div>
            </div>
          </div>
        </div>
      </div>

      <!-- Módulo vacío -->
      <div class="col-md-6">
        <div class="bg-white border rounded-3 p-4 shadow-sm empty-module">
          <div class="text-center">
            <div class="fs-1 mb-3">📭</div>
            <h5 class="text-muted">Módulo Vacío</h5>
            <p class="text-muted">Este espacio está disponible para contenido futuro</p>
          </div>
        </div>
      </div>
    </div>
  </div>


<main>
  <!-- ====== 🏛️ JERARQUÍA (Parte Inferior) ====== -->
  <div class="sticky-bottom">
    <div class="card shadow text-center roman-border">
      <div class="card-body">
        <h2 class="text-success">🏛️ Jerarquía</h2>
        <h3 id="rango" class="fw-bold text-danger">SIN VIRTUD</h3>
        <p id="descripcion">Comienza tu camino hacia la excelencia</p>
        <button onclick="mostrarPiramide()" class="btn btn-outline-warning">Ver Pirámide de Virtud</button>
      </div>
    </div>
  </div>

  <!-- ====== 🏛️ CONTENIDO CENTRAL ====== -->
  <div class="main-content">
    <img src="data/img/casco-logo.png" alt="Escudo Romano" class="center-image" id="rightClickImage">
  </div>

  <script>
    document.addEventListener('DOMContentLoaded', function () {
      const image = document.getElementById('rightClickImage');
      let touchTimer;

      // Detectar toque largo para simular clic derecho
      image.addEventListener('touchstart', function (e) {
        e.preventDefault();
        touchTimer = setTimeout(() => {
          // Disparar evento de clic derecho
          const rightClickEvent = new MouseEvent('contextmenu', {
            bubbles: true,
            cancelable: true,
            view: window,
            button: 2, // Botón derecho
            buttons: 2
          });
          image.dispatchEvent(rightClickEvent);
        }, 80); // 500ms = toque largo
      });

      // Cancelar si el usuario levanta el dedo rápido
      image.addEventListener('touchend', function (e) {
        clearTimeout(touchTimer);
      });

      // Cancelar si el usuario mueve el dedo
      image.addEventListener('touchmove', function (e) {
        clearTimeout(touchTimer);
      });

      // Manejar el clic derecho (nativo del navegador)
      image.addEventListener('contextmenu', function (e) {
        e.preventDefault();
        // Aquí se abrirá el menú contextual nativo del navegador
        // o puedes mostrar tu propio menú personalizado
        console.log('Click derecho activado en la imagen');

        // Para forzar el menú nativo (depende del navegador)
        // Esto puede no funcionar en todos los navegadores móviles
        // debido a restricciones de seguridad
      });
    });
  </script>

  <!-- ====== 🎒 INVENTARIO DE ROPA ====== -->
  <div class="container my-4">
    <div class="row">
      <div class="col-12">
        <div class="card border-warning">
          <div class="card-header d-flex justify-content-between align-items-center">
            <h4 class="mb-0" style="color: white;">🎒 Inventario de Ropa</h4>
          </div>
          <div class="card-body">
            <div class="row" id="inventario-ropa">
              <!-- Los items de ropa se generarán aquí dinámicamente -->
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- ====== 🛒 MODAL VENDER ====== -->
  <div class="modal fade" id="venderModal" tabindex="-1">
    <div class="modal-dialog">
      <div class="modal-content bg-dark border-warning">
        <div class="modal-header">
          <h5 class="modal-title">💰 Vender Ropa</h5>
          <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal"></button>
        </div>
        <div class="modal-body">
          <p>¿Cuántos dragmas vale <strong id="nombre-prenda"></strong>?</p>
          <div class="input-group mb-3">
            <input type="number" class="form-control bg-secondary text-light" id="precio-prenda" min="1" max="100"
              value="10">
            <span class="input-group-text bg-warning text-dark">dragmas</span>
          </div>
          <div class="alert alert-info">
            <small>Dragmas actuales: <span id="dragmas-actuales">100</span></small>
          </div>
        </div>
        <div class="modal-footer">
          <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancelar</button>
          <button type="button" class="btn btn-warning" id="confirmar-venta">Vender</button>
        </div>
      </div>
    </div>
  </div>

  <!-- ====== 🏪 MODAL TIENDA ====== -->
  <div class="modal fade" id="tiendaModal" tabindex="-1">
    <div class="modal-dialog modal-lg">
      <div class="modal-content bg-dark border-warning">
        <div class="modal-header">
          <h5 class="modal-title">🏪 Tienda - Dragmas: <span id="dragmas-tienda">0</span></h5>
          <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal"></button>
        </div>
        <div class="modal-body" id="tienda-contenido">
          <!-- Los componentes de la tienda se cargarán aquí automáticamente -->
        </div>
      </div>
    </div>
  </div>

  <!-- ====== 📜 MODAL MISIONES ====== -->
  <div class="modal fade" id="misionesModal" tabindex="-1">
    <div class="modal-dialog modal-lg">
      <div class="modal-content roman-border">
        <div class="modal-header">
          <h5 class="modal-title">📜 Gestión de Dragmas: <span id="dragmas-misiones">0</span></h5>
          <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
        </div>
        <div class="modal-body">
          <div class="input-group mb-3">
            <input type="number" id="dragmas-input" class="form-control" placeholder="Cantidad de dragmas">
            <button class="btn btn-success" onclick="agregarDragmas()">➕ Agregar</button>
            <button class="btn btn-danger" onclick="quitarDragmas()">➖ Quitar</button>
          </div>

          <div class="row mt-4">
            <div class="col-md-6">
              <h6>💪 Ejercicio Físico</h6>
              <div class="input-group mb-2">
                <input type="number" id="ejercicio-tiempo" class="form-control" placeholder="Tiempo">
                <select id="ejercicio-unidad" class="form-select">
                  <option value="minutos">Minutos</option>
                  <option value="horas">Horas</option>
                </select>
                <button class="btn btn-primary" onclick="registrarEjercicio()">Registrar</button>
              </div>
              <small class="text-muted">Máximo 4 horas por día. Extra: -1 desgaste/30min</small>
            </div>

            <div class="col-md-6">
              <h6>📚 Estudio</h6>
              <div class="mb-2">
                <label>Theoría:</label>
                <div class="input-group">
                  <input type="number" id="teoria-cantidad" class="form-control">
                  <select id="teoria-unidad" class="form-select">
                    <option value="minutos">Minutos</option>
                    <option value="horas">Horas</option>
                    <option value="dias">Días</option>
                    <option value="semanas">Semanas</option>
                    <option value="años">Años</option>
                  </select>
                </div>
              </div>
              <div class="mb-2">
                <label>Práctica:</label>
                <div class="input-group">
                  <input type="number" id="practica-cantidad" class="form-control">
                  <select id="practica-unidad" class="form-select">
                    <option value="minutos">Minutos</option>
                    <option value="horas">Horas</option>
                    <option value="dias">Días</option>
                    <option value="semanas">Semanas</option>
                    <option value="años">Años</option>
                  </select>
                </div>
              </div>
              <button class="btn btn-primary" onclick="registrarEstudio()">Registrar Estudio</button>
            </div>
          </div>

          <div class="row mt-4">
            <div class="col-md-6">
              <h6>🗣️ Influencia Social</h6>
              <div class="input-group mb-3">
                <input type="number" id="personas-hoy" class="form-control" placeholder="Personas hoy" min="0"
                  max="1500">
                <button class="btn btn-info" onclick="registrarInteracciones()">Registrar</button>
              </div>
              <div id="influencia-alerta"></div>
            </div>

            <div class="col-md-6">
              <h6>👥 Gestión de Amigos</h6>
              <button class="btn btn-success w-100 mb-2" onclick="mostrarAgregarAmigo()">➕ Agregar Amigo</button>
              <button class="btn btn-warning w-100" onclick="mostrarEstadisticasAmigos()">📊 Estadísticas</button>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- ====== 👥 MODAL AMIGOS ====== -->
  <div class="modal fade" id="amigosModal" tabindex="-1">
    <div class="modal-dialog">
      <div class="modal-content roman-border">
        <div class="modal-header">
          <h5 class="modal-title">👥 Amigos: <span id="amigos-total">0</span>/50</h5>
          <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
        </div>
        <div class="modal-body">
          <div id="lista-amigos" class="mb-3"></div>
          <div class="progress mb-3">
            <div id="amigos-progress" class="progress-bar" style="width: 0%"></div>
          </div>
          <button class="btn btn-success w-100 mb-2" onclick="mostrarAgregarAmigo()">➕ Agregar Amigo</button>
          <button class="btn btn-danger w-100" onclick="mostrarEliminarAmigo()">🗑️ Eliminar Amigo</button>
        </div>
      </div>
    </div>
  </div>

  <!-- =====️ MODAL AGREGAR AMIGO ====== -->
  <div class="modal fade" id="agregarAmigoModal" tabindex="-1">
    <div class="modal-dialog">
      <div class="modal-content roman-border">
        <div class="modal-header">
          <h5 class="modal-title">➕ Agregar Amigo</h5>
          <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
        </div>
        <div class="modal-body">
          <div class="mb-3">
            <label>Nombre/Apodo:</label>
            <input type="text" id="amigo-nombre" class="form-control">
          </div>
          <div class="mb-3">
            <label>Círculo:</label>
            <select id="amigo-circulo" class="form-select">
              <option value="1">1° Círculo - Familia</option>
              <option value="2">2° Círculo - Familia Lejana</option>
              <option value="3">3° Círculo - Amigo Leal</option>
              <option value="4">4° Círculo - Conocido</option>
              <option value="5">5° Círculo - Herrante</option>
            </select>
          </div>
          <button class="btn btn-primary w-100" onclick="agregarAmigo()">Agregar</button>
        </div>
      </div>
    </div>
  </div>

  <!-- =====️ MODAL PIRÁMIDE ====== -->
  <div class="modal fade" id="piramideModal" tabindex="-1">
    <div class="modal-dialog modal-lg">
      <div class="modal-content roman-border">
        <div class="modal-header">
          <h5 class="modal-title">🏛️ Pirámide de Virtud</h5>
          <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
        </div>
        <div class="modal-body text-center">
          <div class="piramide">
            <div class="nivel-piramide nivel-5" id="nivel-enigma">
              <div class="rango-nombre">ENIGMA ★</div>
              <div class="rango-desc">Creador de realidades</div>
            </div>
            <div class="nivel-piramide nivel-4" id="nivel-alfa">
              <div class="rango-nombre">ALFA ♛</div>
              <div class="rango-desc">Líder nato</div>
            </div>
            <div class="nivel-piramide nivel-3" id="nivel-delta">
              <div class="rango-nombre">DELTA ▼</div>
              <div class="rango-desc">Resiliencia y experiencia</div>
            </div>
            <div class="nivel-piramide nivel-2" id="nivel-beta">
              <div class="rango-nombre">BETA ▬</div>
              <div class="rango-desc">Conformista</div>
            </div>
            <div class="nivel-piramide nivel-1" id="nivel-omega">
              <div class="rango-nombre">OMEGA ▽</div>
              <div class="rango-desc">Base de la pirámide</div>
            </div>
            <div class="nivel-piramide nivel-0" id="nivel-sin-virtud">
              <div class="rango-nombre">SIN VIRTUD</div>
              <div class="rango-desc">Comienza tu camino</div>
            </div>
          </div>
          <div class="mt-3">
            <h6>Tu posición actual: <span id="posicion-actual" class="fw-bold"></span></h6>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- ====== 🔔 TOASTS ====== -->
  <div class="position-fixed bottom-0 end-0 p-3" style="z-index: 11">
    <div id="toast" class="toast align-items-center text-bg-dark border-0" role="alert">
      <div class="d-flex">
        <div id="toast-body" class="toast-body"></div>
        <button type="button" class="btn-close btn-close-white me-2 m-auto" data-bs-dismiss="toast"></button>
      </div>
    </div>
  </div>
</main>

<script src="js/global.js"></script>
<script src="js/home.js"></script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
</body>

</html>